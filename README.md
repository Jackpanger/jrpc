# jrpc
## 1 简介

本文档描述了我们开发的RPC远程调用框架的设计和架构。我们的框架旨在简化分布式系统中的远程调用过程，提供高效、可靠和易用的服务调用方式

## 2 框架概述

我们的RPC远程调用框架包括以下组件:

+ 通信层: 负责处理网络通信，实现请求的传输和响应的接收。我们选择使用TCP协议进行通信，使用Netty作为网络库。
+ 序列化层:负责将请求和响应进行序列化和反序列化，使其在网络传输中进行编码和解码。我们提供了支持常见序列化方式 (如jdk，JSON、Protobuf等)的插件机制，同时也支持自定义序列化方式
+ 服务注册与发现层:负责服务的注册和发现，使客户端可以通过服务名称来发现可用的服务节点。我们使用个中心化的服务注册中心来管理服务的注册和发现。
+ 负载均衡层:负责将请求合理地分配给服务节点，实现负载均衡。我们支持常见的负载均衡策略，如随机、轮询、加权等。
+ 远程代理。在客户端和服务端实现远程代理，封装远程调用的细节，使开发者可以像本地调用一样调用远程服务。

## 3 架构设计

我们的框架采用客户端-服务端架构，以下是框架的整体架构设计:

### 3.1 客户端架构

客户端架构包括以下组件:
。远程代理:根据用户定义的接口，生成代理对象，封装远程调用的细节，将本地方法调用转化为远程调用。。序列化器:将请求和响应进行序列化和反序列化，使其能够在网络中进行传输。我们提供了可配置的插件机制，支持多种序列化方式。
负载均衡器:根据负载均衡策略选择合适的服务节点，将请求发送给服务节点。

通信模块: 使用TCP协议进行网络通信，接收服务节点的响应。

### 3.2 服务端架构

服务端架构包括以下组件:

+ 远程调用处理器:接收来自客户端的请求，根据请求的接口和方法调用相应的服务实现代码，并将结果返回给客户端。
+ 序列化器:将请求和响应进行序列化和反序列化，使其能够在网络中进行传输。我们提供了可配置的插件机制，支持多种序列化方式。
+ 通信模块: 使用TCP协议进行网络通信，接收客户端的请求，并发送服务节点的响应。

### 3.3 注册中心架构

注册中心是中心化的服务注册与发现的管理节点，负责记录和管理可用的服务节点信息，包括服务名称、地址、权重等。客户端和服务端都可以通过注册中心来发现和注册服务。

## 4 工作流程

框架的工作流程如下:

1. 客户端通过远程代理对象调用远程服务.
2. 远程代理将方法调用转化为RPC请求，使用负载均衡策略选择服务节点，并将请求发送给服务节点。
3. 服务节点接收到请求后，使用序列化器对请求进行反序列化，找到对应的服务实现代码，并调用相应的方法。
4. 服务实现完成后，将结果返回给服务节点.
5. 服务节点使用序列化器对结果进行序列化，并将结果发送给客户端。
6. 客户端接收到响应后，使用序列化器对响应进行反序列化，并将结果返回给用户。

## 5 扩展性和可靠性

我们的框架**具有良好的扩展性和可靠性**。以下是一些关键设计和决策:

+ 插件机制:我们**使用插件机制来支持多种序列化方式和负载均衡策略**。开发者可以根据自己的需求实现自定义插件，来支持其他的序列化方式或负载均衡策略。
+ 服务注册中心:使用中心化的服务注册中心来管理服务的注册和发现，提供可靠的服务节点信息。注册中心可以实现高可用以确保系统的可靠性和稳定性。
+ 异常处理:我们的框架会对**网络异常、超时等情况进行处理，提供合适的错误信息和异常处理机制，以保证框架的可靠性。**
+ 日志和监控:框架会记录关键的日志信息，方便开发者定位和解决问题，此外，我们也提供监控和性能统计功能，供开发者进行系统性能分析和优化。

## 6 总结

本文档概述了我们的RPC远程调用框架的设计和架构。通过清晰的组件划分和工作流程描述，我们的框架实现了简化分布式系统中的远程调用过程，并提供高效、可靠和易用的服务调用方式，我们相信这个框架能够满乐您的需求，并为您的分布式系统开发带来便利和效率。如果对框架设计有任何疑问或建议，请随时与我们交流。